# ProLife 桌面小组件 - 测试验证清单

## 测试步骤

### 1. 基础功能测试

#### 1.1 主应用数据导出
- [ ] 启动主应用 `npm start`
- [ ] 添加一些测试数据（任务、项目、每日计划）
- [ ] 检查 `%APPDATA%/ProLife/widget-data.json` 是否生成
- [ ] 验证文件内容包含：todos, projects, dailyPlans, groups, auth

#### 1.2 从主应用启动小组件
- [ ] 点击主应用顶部工具栏的小组件图标（方格图标）
- [ ] 确认弹出提示"正在启动桌面小组件..."
- [ ] 小组件窗口应该在 2-3 秒内出现
- [ ] 验证小组件显示了主应用的数据

#### 1.3 小组件独立启动
- [ ] 关闭主应用
- [ ] 进入 `widget/` 目录
- [ ] 运行 `npx electron .` 或双击 `start-widget.bat`
- [ ] 小组件应该正常启动并显示数据

### 2. 数据显示测试

#### 2.1 任务标签页
- [ ] 只显示独立任务（不属于任何项目的任务）
- [ ] 项目内的任务不应该出现在这里
- [ ] 任务按优先级排序（高 > 中 > 低）
- [ ] 同优先级按 DDL 时间排序
- [ ] 逾期任务显示红色左边框
- [ ] 显示优先级圆点（红/黄/绿）
- [ ] 显示分组标签和颜色
- [ ] 显示 DDL 日期和时间
- [ ] 未完成任务数量显示在标签页标题

#### 2.2 项目标签页
- [ ] 显示所有项目
- [ ] 显示项目状态（进行中/已完成/暂停）
- [ ] 显示进度条和百分比
- [ ] 显示任务完成情况（x/y 任务）
- [ ] 显示项目截止日期
- [ ] 逾期项目日期显示红色

#### 2.3 今日计划标签页
- [ ] 只显示今天的计划
- [ ] 按时间排序
- [ ] 显示时间段
- [ ] 显示计划内容

### 3. 交互功能测试

#### 3.1 任务完成
- [ ] 点击任务前的复选框
- [ ] 任务立即变为半透明 + 删除线
- [ ] 刷新主应用，确认任务状态已同步
- [ ] 检查 `widget-data.json` 文件已更新

#### 3.2 每日计划完成
- [ ] 点击计划前的复选框
- [ ] 计划立即变为半透明 + 删除线
- [ ] 刷新主应用，确认计划状态已同步

#### 3.3 打开主应用
- [ ] 点击底部"打开 ProLife"按钮
- [ ] 主应用应该启动（如果未运行）
- [ ] 如果主应用已运行，应该聚焦到主窗口

### 4. UI 功能测试

#### 4.1 主题切换
- [ ] 点击顶部月亮/太阳图标
- [ ] 界面切换到暗色/亮色模式
- [ ] 所有颜色正确切换
- [ ] Pop-art 风格保持一致

#### 4.2 置顶功能
- [ ] 点击顶部图钉图标
- [ ] 窗口应该始终在最前
- [ ] 再次点击取消置顶
- [ ] 图标透明度变化（置顶=1.0，非置顶=0.4）

#### 4.3 刷新功能
- [ ] 点击顶部刷新图标
- [ ] 底部状态显示"刷新中..."
- [ ] 数据重新加载
- [ ] 状态更新为"本地数据 HH:MM"或"已同步 HH:MM"

#### 4.4 窗口拖拽
- [ ] 拖拽顶部黄色标题栏
- [ ] 窗口应该跟随鼠标移动
- [ ] 关闭后重新打开，窗口位置应该保持

### 5. 托盘功能测试

#### 5.1 托盘图标
- [ ] 小组件启动后，系统托盘出现图标
- [ ] 右键点击托盘图标，显示菜单
- [ ] 菜单包含：刷新、显示/隐藏、打开 ProLife、退出

#### 5.2 托盘菜单操作
- [ ] 点击"刷新"，小组件重新加载
- [ ] 点击"显示/隐藏"，窗口切换可见性
- [ ] 点击"打开 ProLife"，主应用启动
- [ ] 点击"退出"，小组件关闭

### 6. 云端同步测试

#### 6.1 有网络 + 已登录
- [ ] 主应用登录 Supabase 账号
- [ ] 启动小组件
- [ ] 小组件应该从云端拉取最新数据
- [ ] 底部状态显示"已同步 HH:MM"

#### 6.2 无网络 / 未登录
- [ ] 断开网络或未登录
- [ ] 启动小组件
- [ ] 小组件应该使用本地文件数据
- [ ] 底部状态显示"本地数据 HH:MM"

#### 6.3 操作同步
- [ ] 在小组件中完成一个任务
- [ ] 等待 2-3 秒
- [ ] 刷新主应用，确认任务状态已同步
- [ ] 在另一台设备登录，确认云端数据已更新

### 7. 打包测试

#### 7.1 构建应用
```bash
cd H:/claude
npm run build:win
```
- [ ] 构建成功，无错误
- [ ] `dist/ProLife-win32-x64/` 目录包含 `widget/` 文件夹
- [ ] widget 文件夹包含：widget-main.js, widget.html, package.json

#### 7.2 打包后运行
- [ ] 运行 `dist/ProLife-win32-x64/ProLife.exe`
- [ ] 主应用正常启动
- [ ] 点击小组件图标
- [ ] 小组件正常启动
- [ ] 所有功能正常工作

### 8. 边界情况测试

#### 8.1 空数据
- [ ] 删除 `%APPDATA%/ProLife/widget-data.json`
- [ ] 启动小组件
- [ ] 显示"没有待办任务"/"没有项目"/"今天没有计划"

#### 8.2 重复启动
- [ ] 小组件已运行
- [ ] 再次点击主应用的小组件图标
- [ ] 不应该启动第二个小组件实例
- [ ] 控制台显示"小组件已在运行"

#### 8.3 主应用关闭
- [ ] 小组件运行中
- [ ] 关闭主应用
- [ ] 小组件应该继续运行
- [ ] 小组件功能正常

#### 8.4 数据过滤
- [ ] 创建一个项目，添加任务到项目中
- [ ] 创建一些独立任务（不属于项目）
- [ ] 小组件"任务"标签页只显示独立任务
- [ ] 项目内的任务只在"项目"标签页显示

## 已知问题

记录测试中发现的问题：

1.

## 测试环境

- 操作系统：Windows 11 Home China 10.0.26200
- Node.js 版本：
- Electron 版本：^28.0.0
- 测试日期：2026-02-27
